{-# LANGUAGE TemplateHaskell, QuasiQuotes #-}
module Advent2
    ( advent2_1, advent2_2
    ) where

import Text.Heredoc
import Data.List
import Data.List.Split

-- Answers

advent2_1 = sum $ map (roundScore . score . outcome) $ parseInput input

advent2_2 = 0

parseInput :: String -> [(Player, Player)]
parseInput ipt = map readIntoMatch $ map words $ splitOn "\n" ipt

readIntoMatch :: [String] -> (Player, Player)
readIntoMatch [x, y] = (readIntoMatchA x, readIntoMatchB y)
    where
        readIntoMatchA "A" = Rock
        readIntoMatchA "B" = Paper
        readIntoMatchA "C" = Scissor
        readIntoMatchB "X" = Rock
        readIntoMatchB "Y" = Paper
        readIntoMatchB "Z" = Scissor

roundScore :: (Int, Int, Int) -> Int
roundScore (x, y, z) = y + z

score :: (Result, Player) -> (Int, Int, Int)
score (PlayerAWins, p) = (6, 0, score' p)
score (PlayerBWins, p) = (0, 6, score' p)
score (Draw, p) = (3, 3, score' p)
    
score' Rock = 1
score' Paper = 2
score' Scissor = 3

outcome :: (Player, Player) -> (Result, Player)
outcome (x, y)
    | a == EQ = (Draw, y)
    | a == LT = (PlayerBWins, y)
    | a == GT = (PlayerAWins, y)
    where a = compare x y

data Result = PlayerAWins | PlayerBWins | Draw deriving Show
data Player = Rock | Paper | Scissor deriving Eq

instance Ord Player where
    compare Rock x = case x of
        Rock -> EQ
        Paper -> LT
        Scissor -> GT
    compare Paper x = case x of
        Rock -> GT
        Paper -> EQ
        Scissor -> LT
    compare Scissor x = case x of
        Rock -> LT
        Paper -> GT
        Scissor -> EQ


-- Input

example_input = [here|A Y
B X
C Z|]

input = [here|A X
A X
B Y
B Y
A Y
A X
A Y
A X
A X
B Y
A X
A X
A X
A X
C X
C Z
A X
B Y
A X
A X
C X
C Y
A X
A Z
B Y
A X
C X
A X
B Y
A X
A X
A X
A Z
C X
C X
C X
B Y
B X
B Z
B Y
C X
A Y
A X
A X
B X
A X
A X
B Y
C X
B Y
A X
A X
A X
C X
B Y
C X
B Y
A X
C X
B Y
B X
B Y
C Z
A X
A Y
C Z
C X
A X
C X
A X
A X
C Z
B Y
C X
B X
B X
C X
A X
A X
A X
C Z
C X
B Y
A X
C X
B Z
A X
C Z
C Z
A X
A X
A X
A Y
A X
A X
B Y
A X
C Z
C Z
A X
A X
C X
A Y
A Y
A X
A X
A X
B Z
A X
A Z
A X
A X
A X
C Z
C Z
A X
B Y
C Z
A X
A X
A X
A X
A Y
B Y
A Z
A X
A X
A X
A Z
A X
C Z
C Z
C X
C Z
A X
B Y
C Y
A X
B Y
A X
A X
A X
A X
A X
C X
A X
A X
B X
A X
B Y
A X
B Y
A X
B Y
B Y
C X
A X
A X
A X
A Z
C X
A Y
C X
C X
B Y
A X
A X
C Z
A X
C X
B Y
A Y
A X
A X
B Y
A X
A X
C X
A Z
A X
A X
A X
B Y
B Y
B Z
A Z
A X
B Y
B Y
A X
A X
A X
B Z
C Z
A X
A Y
A X
A X
A X
A X
C X
A Y
A X
B Z
C Z
C Z
A X
C X
B Y
A X
A X
B Y
A X
B Y
B Y
A X
A X
A X
A X
A X
B Y
B Y
A X
B X
C X
A X
B Y
A X
A X
A X
B Y
B Y
A Z
C Z
B X
C X
A X
A X
B Y
A Y
A X
A X
A X
A Z
B Y
A X
A Y
A X
A X
A X
A Z
A X
B Y
A X
A X
C X
B Y
B Y
B Y
A X
A Y
B Y
B Y
A X
B Y
A Y
A Y
A X
A X
B Y
A X
A X
A X
A Y
B Y
A Z
A X
C Z
A X
A Y
A Z
A X
A Z
A X
A X
A X
A Z
C X
A X
A X
C Z
A X
A X
C X
C Z
B Y
B Y
C Z
C X
A X
C Z
A Z
B Y
B Y
C Z
C X
A X
C Z
A X
A X
A Y
A X
B Y
B Y
C Y
A X
C X
A X
C X
A X
A Y
A X
C X
C Z
C X
B Y
A X
A X
A Z
C Z
A X
B Y
A X
B X
C Z
C Z
B Z
B Y
A X
A X
A X
A X
C Z
C Z
A X
A X
A X
C X
A X
A X
A X
B Y
A Y
A X
C X
C Z
A X
C Z
B Y
A X
A X
A Y
A X
B Y
C X
A X
A Y
A Y
B X
A Y
C Z
B Y
A X
C Z
C X
B Y
B Y
B Y
A X
A X
A X
A X
A X
A X
A X
A Y
A X
B Z
A X
A X
A X
C Z
A X
A X
A X
A X
A X
A X
B Y
C X
B Y
A X
A X
A X
A X
C Z
A X
A X
C X
A X
A X
B Y
A X
B X
A X
A X
A X
A Y
B X
B Y
B Y
A X
C X
A X
A Y
B Z
A Y
A Z
B Y
B Y
A X
A Y
A X
B Y
A X
B Z
A X
A X
A X
A X
A X
B Y
B Y
A X
A X
B Y
A Y
A X
B Z
A X
A X
A X
A X
B Z
B Y
A X
C X
A X
A X
A X
B Y
C Z
C Z
B Y
B Y
A X
B Y
A Y
C X
A X
A X
A X
A Y
C Z
A X
A Z
B Y
B Y
B Y
A X
B Z
C Z
A X
A Y
C Z
A X
B Y
A X
B Y
A Z
A X
A X
A X
A Y
A X
A X
B Y
A X
C X
C Z
A X
A X
C Z
A X
C X
A X
A X
A X
C Z
A X
A X
B Y
A X
C X
B Y
A X
B Y
A X
A X
A X
A X
C Z
B Y
A X
A X
A X
A X
A X
A X
C X
A X
A X
B Y
A X
B Y
A X
A X
C X
A X
A X
A X
A X
C Z
B Y
C Z
C X
A Y
A X
A X
A X
C X
A Y
A X
A X
A X
A X
A X
C Z
A X
A X
A X
B Y
A Z
A X
A X
C Z
B X
A Z
A X
B Y
B Y
B Y
B Y
B Y
A X
B Y
A X
A X
A Z
B X
B Y
A X
C Y
A X
A X
A X
A X
B Y
C X
A Y
A X
A X
B Z
A X
B Y
A Z
A Y
A X
A X
C X
A Y
C X
A X
A Y
A X
B Y
C X
A X
C Z
A X
A X
A X
A X
A X
B X
C Y
B Y
A X
C X
C X
A X
C X
C Z
A X
A X
A X
B Y
C X
B Y
B Y
A X
A X
C X
A X
C Z
A X
A Y
A X
B Y
A X
A X
A X
A X
C Z
A X
B Y
B Y
A X
B Y
A X
A Z
A X
C Y
B Y
A X
A X
C X
B Y
B Y
A Y
A X
C Y
B Y
A Y
A X
A Z
C Y
A X
A X
A Y
C X
C Y
A X
B Y
A X
A X
C Z
A Z
C Z
A Y
A X
A X
C X
C Z
A Z
B Y
B Y
B Y
A X
A Z
C X
A X
A X
B Y
A X
A X
C Z
A Y
A Y
C Z
A X
A X
C Y
B Z
A Y
A Z
A X
C X
A X
A X
A X
A X
B Y
B Y
C Z
A X
C X
B Y
A X
A X
A X
A X
A X
A X
A X
A X
C Z
A Y
C X
C Z
A X
A X
A Y
A X
A X
C X
C X
B Y
A X
B Y
B Y
A Z
A X
A Y
A Y
A X
A X
A X
B Y
B X
A X
B Y
B Y
A X
A Y
A Y
A X
C Z
A X
A X
A Z
C Z
B Z
A X
A X
A X
A Y
C X
A X
B Y
A X
B Z
A Y
A X
B Y
A X
C X
A X
B Y
A X
C X
C X
C Z
A X
A X
C Y
A X
B Y
A X
B X
A X
B X
A X
A Y
A X
C X
C X
A X
A X
A Y
A X
A X
C X
A X
B Y
A X
A X
C Y
A X
A X
A X
C X
A X
B Z
A X
A Z
A X
A X
A Z
A X
A X
A X
A Y
B Y
A X
A X
A X
B Z
B Y
A Z
B X
B Y
A X
C X
B Y
A X
A X
B Y
A X
C X
A Z
A X
A Z
A Z
B Y
A X
C X
C Z
A X
B Y
A X
B Y
C Z
A X
C Z
B Y
C X
C X
C Z
B Y
A X
B Y
C X
C X
A X
B Y
A X
A X
A Y
C Z
B Y
A X
A Z
A Y
A X
A Y
C X
A X
A X
A X
C X
A X
A X
A X
B Y
C Y
B Y
A X
B Y
B Y
A X
A X
A X
A X
A X
C Z
B Y
B X
B Y
A X
A Z
A X
A X
B Y
B Y
C X
C Z
A X
C Z
B Y
A Z
A X
A X
A X
A X
B Z
B Y
A X
A X
A X
A X
A X
B Y
B X
B Y
C X
B Y
C X
B Y
A X
A X
B Y
A X
C Z
B Y
C X
A Z
B Y
B Y
A X
B Y
A X
A Y
B Y
B Y
B Z
C Z
A X
C X
A Y
B X
A X
A X
A X
C Z
B Y
B Y
A Y
B Y
A X
B Y
A X
C X
A X
A X
A X
A Y
A Y
A Z
A X
B Y
A X
A X
A X
A X
A X
A X
A Z
A X
A X
B Y
C Z
C X
C Z
B Y
A X
A Z
A Z
A Y
B X
A X
A X
C Y
A Z
A X
A X
B Y
A X
B X
A Z
A X
A X
A X
A X
A Y
A X
A Z
A X
B Y
B Z
C Z
A Y
B Y
A Y
C X
B Y
B Y
A Z
A X
A X
A Y
A X
A X
A X
A X
C Z
B X
A X
B Y
C X
A X
A X
C X
B Y
C Z
C Z
B Y
C X
A X
C Z
B Y
A X
C Z
A Y
B Y
A X
A Z
A Z
B Z
A X
A Z
A X
C Z
C X
A X
C X
A Y
C X
A X
A X
A Z
B Z
B Y
B Y
A X
A X
A X
A Z
A X
B Y
C Z
A X
A X
A Z
A X
B Y
B Y
C X
A X
A X
A X
C Z
C X
B Y
A X
A X
B Y
C Z
B Y
A Y
A X
C X
A Z
A X
A X
A X
C X
A X
A X
A X
A X
C Z
B Y
A X
A X
C Z
C X
B Y
B Y
C X
B Y
A X
A X
A X
C X
A X
A X
A Z
A X
A X
B Z
A X
C X
B Y
A Z
B Y
A X
A X
B Z
A X
A X
A X
B Y
A X
A X
A X
A X
B Y
A Y
A X
B X
A X
A X
A X
A X
C Z
B Y
A X
C Z
C Z
B Y
C Z
A X
A Y
B Y
B Y
A X
A X
A X
A X
A X
A X
B Y
A Y
B Y
A X
B Y
B Y
B Z
A Y
B Y
C Z
A X
A X
B Y
A X
A X
A X
A Y
A X
A X
B Y
A Y
A X
A X
A X
B Y
A X
C X
A X
C X
B Y
C X
A X
B Y
A Z
A X
A X
B Y
A X
A X
A X
B X
A X
A X
A X
B Y
A Z
B Y
B Y
C X
C X
B Y
A Y
A X
B Y
A X
B Z
A X
A X
B Y
A Y
A X
A Y
A X
C Z
A X
C Z
B Y
A Y
B Y
A X
A Z
A X
B Y
B X
B Y
A X
A Y
A X
A X
A X
A X
C X
A X
B Y
C X
A Y
B Y
B Y
A X
A X
C Z
A X
C X
B Y
A X
A X
B Y
A Y
A X
A Z
A X
C X
B Y
B Y
C X
A X
B Y
A X
B Y
C X
A X
B Y
A X
A Z
A X
C X
A Z
A X
A X
A Y
A X
A X
A X
A Y
A X
A X
A X
A X
A X
B Y
C X
C Z
C X
A X
B Y
C Z
B X
A X
A X
B Y
A X
A X
C Z
C X
C X
A X
A Y
B Y
A Y
C X
B Y
A X
A X
A Y
A X
A X
B X
C X
A Y
B Y
B Y
A X
B Y
A X
A Y
A X
A X
B Y
B Y
A X
B Y
A X
C X
C X
C Z
A X
A X
A X
B Y
C X
A X
A X
B Y
A X
C X
A Y
A X
A X
A X
C X
A X
A Z
A X
A X
A X
A Y
C Z
A Y
A X
B Z
A X
A X
B Y
C Z
A X
B Y
B Y
A X
B Y
A Y
A X
B Y
B Y
A X
C Z
B Y
A X
B Z
C Z
B Y
A X
C Z
A X
A X
A Z
A X
A X
A X
A X
A X
A X
C Z
A X
A X
B X
A X
A X
A X
A Z
A X
C X
A X
C Y
A X
B X
C X
A X
B Y
B Y
A X
C X
A X
A X
A X
A Y
A X
B Y
C Z
B Y
A Z
A X
A X
A Z
C Z
C X
C X
B Y
C X
A X
A X
A X
A X
B Y
A X
A X
A Y
C X
A X
C X
A X
A X
A X
C X
C X
A X
A X
B Y
A X
A X
A X
A Y
B Y
A X
A X
C X
A X
B Y
C X
C Y
C X
B Y
B Z
A X
A X
A Z
C X
A X
A X
A X
A X
A X
B Z
A Z
A X
A X
A X
A X
A Y
A X
C X
A Z
A X
A Z
C X
A X
A X
A X
A Z
A Y
A X
C Z
A X
A X
B Y
A X
A X
A X
A Y
B Y
A X
B Y
B Y
C Z
B Y
A X
A X
A X
A X
A X
A X
A Y
A X
A X
B Y
A Y
A X
A X
C X
A X
B Y
A X
B Y
A X
A X
C X
A Y
A X
C X
B Y
C X
A X
A X
A X
C X
A X
A X
A X
C Z
A X
A X
B Y
A X
A X
A X
A X
C Z
A X
C Z
B Y
C X
A X
A Y
A X
A Z
A X
C X
C Z
A X
C X
A X
A X
A X
A X
C Z
B Y
A X
C X
B Y
C X
C Z
C Z
C X
C Z
C Z
A Y
A Z
C Z
A X
A Y
A Y
A X
A X
B Y
A X
B Y
A X
A Y
C X
A X
A X
A X
C Z
C Z
B Y
A X
B Y
C X
A X
A X
A X
A Y
B Y
A X
C X
C Y
C X
A X
A X
C Z
B Y
A X
B Y
A X
A X
C Z
B Y
A X
A Z
C Y
A Z
A X
C X
A Y
A X
C Z
C X
A X
A X
A X
A X
A X
A X
A X
A Y
A X
A X
A X
C X
C X
B Y
B Y
A X
B Y
A X
C X
C Z
C X
B Y
C X
B Y
B Y
A X
B X
C Z
A X
A X
B Y
A X
B Y
A X
B Y
A X
A X
A X
A X
A X
A X
A X
A X
A X
C Z
A X
A X
A X
A X
B Y
A X
B Y
B Y
C Y
B Y
A X
B Y
B Y
C X
C Z
C X
C Z
A X
C X
A X
A X
A Y
A X
B Y
A X
B Y
B Y
B Y
A X
A X
A X
A X
A X
B Y
A X
C X
B Y
C X
A X
A X
C X
B Y
C Z
C X
B Y
A X
A X
B Y
A X
A X
A Y
C Z
A X
B Y
B Y
A X
B Y
C Z
A Z
A Y
A X
B Y
A Y
B Y
B Y
C Z
A Y
A X
A Y
B Y
A X
A X
C Z
A X
B Y
A X
B Y
B Y
A X
A X
A X
B Y
B Y
A X
A X
C X
B Z
A X
B X
B Y
C Z
B Y
C Z
C Z
A X
A Z
A X
A X
A X
A X
A X
B Z
B Y
C X
A X
A X
B Y
C X
C Z
B Y
C X
B Y
A X
A X
C Z
A X
A Y
B Y
A X
A X
A X
A X
A X
A X
A X
B Y
A Y
B Y
B Y
A X
B Y
A Z
B Y
A X
A X
A X
C Z
C X
C X
B Y
A X
C Z
C X
A X
A X
C Z
A X
A X
A Z
C Z
B Y
C X
A X
A X
B Y
A Y
A X
A Z
C Z
A X
C Y
A X
B Y
A X
B Z
A X
A X
A X
A Y
C X
A X
A Z
B Y
A X
A X
B Y
C X
C Z
A Y
C Z
A Z
B Y
A X
A X
C Z
A Z
C X
A X
A Y
A X
A X
A Y
A X
A X
A Z
A X
A X
A Y
C X
A X
A X
A Y
B Y
A X
B Y
B Y
A X
C X
A X
A X
C X
A Y
A X
A X
B Y
A X
C X
C Z
B Y
C X
A Y
A Y
A X
A X
A X
B Y
B Z
A X
A X
B Y
B Y
B Y
C Z
B Y
B Y
A X
B Z
A X
A X
A X
A X
B Y
A X
C X
B Y
B Y
A X
A X
B Y
B Y
B X
A X
A X
A X
A X
C Z
A X
A X
B Y
A X
A X
B Y
C X
B Y
A X
A X
B Y
A X
A X
A X
C Z
B Y
B Y
A Y
B X
A X
B Y
C Z
A X
A X
C Z
A X
A X
A Y
C X
A X
C X
A Y
A Y
A X
A Z
A X
C X
C Z
C X
B Y
A X
C Z
A Z
B X
B Y
C Z
C X
C X
B Y
A Y
B Y
A X
A X
A Z
B Y
A X
A X
A Y
A X
A X
B Y
B Z
B Y
A X
A X
A Y
A X
A X
A Y
B Y
C Z
C Z
C Z
B Y
A X
A X
B Y
C X
A X
A X
A Y
A X
B Y
B X
A X
C Z
A X
A X
A X
A Y
A X
C X
A X
A X
C Z
A X
A X
A X
A X
A Z
B Y
A X
A X
C X
C X
C X
B Y
A X
A X
A X
B Y
B Y
A X
C X
C Y
A X
A X
A X
B Y
B Y
A X
A X
A Z
A X
A Y
A X
B Y
A Z
B Y
C X
A Z
C X
B Y
A X
A X
B Y
A X
C Z
B Y
B Y
A X
B X
A X
B Y
B Y
A X
A X
A X
A X
A Y
B Y
A Y
B Y
B Y
C X
A Z
A X
A X
A X
A X
C Z
A X
A X
C X
C X
A Z
A X
A Z
C X
C Z
B Y
B Y
A Z
B Y
B Y
B Y
A X
C X
C X
A Y
B Y
A X
A X
A X
B Y
C Z
C X
A Z
A X
C Z
A X
A X
C X
A X
B Y
A X
A Z
B Y
A X
A X
A X
C X
A X
A X
A X
A X
A X
A X
B Y
B Y
B Y
B X
A X
A Z
C X
A X
B Y
A X
A X
C Z
C X
B Y
A X
A X
A X
C X
A X
A X
B Y
A X
C Y
A Y
A Z
B Y
A Y
B Y
B Y
A X
A X
A X
A X
A X
A X
A Y
A X
C X
C X
C X
C Z
A Z
A X
B Z
B Y
B Y
A Z
A X
A X
C Z
B Y
B Y
C X
A X
B Y
B Y
A X
C X
C Z
B Y
B Y
B Y
A X
B Y
B Y
A X
A X
A X
A X
B Y
B Y
B Y
A X
A X
A X
B Y
B Y
A X
A X
C X
A Y
B Z
C X
A X
A Y
A X
A X
C Z
A X
C X
B Y
A X
C Z
C Y
A X
C Z
A Z
C Z
C X
B Y
B Y
A X
B Z
A X
A X
B X
A X
A X
A X
A X
C Z
C X
A X
B Y
A X
C X
A X
B Y
C Z
A X
C X
A Y
A X
A X
A X
A X
A X
B Y
B Y
A X
A X
B Y
B Y
C Z
C X
A X
A X
B Z
A X
A X
A Z
A X
A X
A X
A X
C X
A X
A X
A X
B Z
C Z
B Y
B Y
C Z
C X
A X
A X
B Y
A X
A X
B Y
A X
A Y
C X
B Y
A X
C X
A X
B Y
C X
B Y
A X
C X
A X
A X
C X
A X
C X
A X
C X
A X
A X
B Y
A X
A X
A X
A X
A X
A X
A X
A Y
A X
A X
C X
B Y
C Z
A X
B Y
A X
B Y
C Z
C Z
B Y
A X
A X
A X
A X
A Y
A X
A Z
A X
C Y
C X
C Z
A X
A X
A X
A X
A X
C Z
C X
A X
A X
B Z
A X
C X
A Z
B Y
C Z
A X
A X
A Z
B Y
A X
B Z
A X
A X
A Y
A X
A X
C Z
A X
B Y
B X
A X
C X
A X
C X
B Y
A X
A X
B Z
A X
A X
B Y
B Y
A Z
C X
A X
A X
A Z
A X
A Z
A X
A X
A X
B Y
A X
C X
C X
A Z
B Y
B Y
A X
A X
A X
A X
A X
A X
C X
A X
A Y
C X
A X
A X
A X
C X
A X
A X
A X
A X
A X
B Z
A X
A X
C Y
B Y
C X
A X
A X
A X
A X
A X
C X
A Y
B Y
A X
A X
A X
A Y
A X
C X
A Z
A X
C Z
C X
A X
A X
A X
A X
C X
C X
B Y
A Z
A Y
B Y
C X
C Z
B Y
B Y
A X
C X
A X
A Y
B Y
A X
C X
C X
B Y
A X
B Y
A Y
A X
B X
A X
A X
B Y
A X
B X
B Y
A X
C Z
A X
A Z
A X
A X
C X
A Y
A X
C X
A X
A X
A X|]